!function(e,t,n){var r=function(){function r(){if("string"==typeof t.pagenow&&(q.screenId=t.pagenow),"string"==typeof t.ajaxurl&&(q.url=t.ajaxurl),"object"==typeof t.heartbeatSettings){var n=t.heartbeatSettings;!q.url&&n.ajaxurl&&(q.url=n.ajaxurl),n.interval&&(q.mainInterval=n.interval,q.mainInterval<15?q.mainInterval=15:q.mainInterval>60&&(q.mainInterval=60)),q.screenId||(q.screenId=n.screenId||"front"),"disable"===n.suspension&&(q.suspendEnabled=!1)}q.mainInterval=1e3*q.mainInterval,q.originalInterval=q.mainInterval,e(t).on("blur.wp-heartbeat-focus",function(){v(),q.winBlurTimer=t.setTimeout(function(){l()},500)}).on("focus.wp-heartbeat-focus",function(){d(),f()}).on("unload.wp-heartbeat",function(){q.suspend=!0,q.xhr&&4!==q.xhr.readyState&&q.xhr.abort()}),t.setInterval(function(){m()},3e4),j.ready(function(){q.lastTick=a(),s()})}function a(){return(new Date).getTime()}function o(e){var n,r=e.src;if(r&&/^https?:\/\//.test(r)&&(n=t.location.origin?t.location.origin:t.location.protocol+"//"+t.location.host,0!==r.indexOf(n)))return!1;try{if(e.contentWindow.document)return!0}catch(a){}return!1}function i(e,t){var n;if(e){switch(e){case"abort":break;case"timeout":n=!0;break;case"error":if(503===t&&q.hasConnected){n=!0;break}case"parsererror":case"empty":case"unknown":q.errorcount++,q.errorcount>2&&q.hasConnected&&(n=!0)}n&&!w()&&(q.connectionError=!0,j.trigger("heartbeat-connection-lost",[e,t]))}}function c(){q.hasConnected=!0,w()&&(q.errorcount=0,q.connectionError=!1,j.trigger("heartbeat-connection-restored"))}function u(){var n,r;q.connecting||q.suspend||(q.lastTick=a(),r=e.extend({},q.queue),q.queue={},j.trigger("heartbeat-send",[r]),n={data:r,interval:q.tempInterval?q.tempInterval/1e3:q.mainInterval/1e3,_nonce:"object"==typeof t.heartbeatSettings?t.heartbeatSettings.nonce:"",action:"heartbeat",screen_id:q.screenId,has_focus:q.hasFocus},q.connecting=!0,q.xhr=e.ajax({url:q.url,type:"post",timeout:3e4,data:n,dataType:"json"}).always(function(){q.connecting=!1,s()}).done(function(e,t,n){var r;return e?(c(),e.nonces_expired?(j.trigger("heartbeat-nonces-expired"),void 0):(e.heartbeat_interval&&(r=e.heartbeat_interval,delete e.heartbeat_interval),j.trigger("heartbeat-tick",[e,t,n]),r&&y(r),void 0)):(i("empty"),void 0)}).fail(function(e,t,n){i(t||"unknown",e.status),j.trigger("heartbeat-error",[e,t,n])}))}function s(){var e=a()-q.lastTick,n=q.mainInterval;q.suspend||(q.hasFocus?q.countdown>0&&q.tempInterval&&(n=q.tempInterval,q.countdown--,q.countdown<1&&(q.tempInterval=0)):n=12e4,t.clearTimeout(q.beatTimer),n>e?q.beatTimer=t.setTimeout(function(){u()},n-e):u())}function l(){p(),q.hasFocus=!1}function f(){p(),q.userActivity=a(),q.suspend=!1,q.hasFocus||(q.hasFocus=!0,s())}function v(){e("iframe").each(function(n,r){o(r)&&(e.data(r,"wp-heartbeat-focus")||(e.data(r,"wp-heartbeat-focus",1),e(r.contentWindow).on("focus.wp-heartbeat-focus",function(){f()}).on("blur.wp-heartbeat-focus",function(){v(),q.frameBlurTimer=t.setTimeout(function(){l()},500)})))})}function d(){e("iframe").each(function(t,n){o(n)&&(e.removeData(n,"wp-heartbeat-focus"),e(n.contentWindow).off(".wp-heartbeat-focus"))})}function p(){t.clearTimeout(q.winBlurTimer),t.clearTimeout(q.frameBlurTimer)}function h(){q.userActivityEvents=!1,j.off(".wp-heartbeat-active"),e("iframe").each(function(t,n){o(n)&&e(n.contentWindow).off(".wp-heartbeat-active")}),f()}function m(){var t=q.userActivity?a()-q.userActivity:0;t>3e5&&q.hasFocus&&l(),q.suspendEnabled&&t>12e5&&(q.suspend=!0),q.userActivityEvents||(j.on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active",function(){h()}),e("iframe").each(function(t,n){o(n)&&e(n.contentWindow).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active",function(){h()})}),q.userActivityEvents=!0)}function b(){return q.hasFocus}function w(){return q.connectionError}function I(){q.lastTick=0,s()}function g(){q.suspendEnabled=!1}function y(e,t){var n,r=q.tempInterval?q.tempInterval:q.mainInterval;if(e){switch(e){case"fast":case 5:n=5e3;break;case 15:n=15e3;break;case 30:n=3e4;break;case 60:n=6e4;break;case"long-polling":return q.mainInterval=0,0;default:n=q.originalInterval}5e3===n?(t=parseInt(t,10)||30,t=1>t||t>30?30:t,q.countdown=t,q.tempInterval=n):(q.countdown=0,q.tempInterval=0,q.mainInterval=n),n!==r&&s()}return q.tempInterval?q.tempInterval/1e3:q.mainInterval/1e3}function T(e,t,n){return e?n&&this.isQueued(e)?!1:(q.queue[e]=t,!0):!1}function k(e){return e?q.queue.hasOwnProperty(e):void 0}function x(e){e&&delete q.queue[e]}function E(e){return e?this.isQueued(e)?q.queue[e]:n:void 0}var j=e(document),q={suspend:!1,suspendEnabled:!0,screenId:"",url:"",lastTick:0,queue:{},mainInterval:60,tempInterval:0,originalInterval:0,countdown:0,connecting:!1,connectionError:!1,errorcount:0,hasConnected:!1,hasFocus:!0,userActivity:0,userActivityEvents:!1,beatTimer:0,winBlurTimer:0,frameBlurTimer:0};return r(),{hasFocus:b,connectNow:I,disableSuspend:g,interval:y,hasConnectionError:w,enqueue:T,dequeue:x,isQueued:k,getQueuedItem:E}};t.wp=t.wp||{},t.wp.heartbeat=new r}(jQuery,window);