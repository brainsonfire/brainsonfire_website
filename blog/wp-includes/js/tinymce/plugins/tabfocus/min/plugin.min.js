tinymce.PluginManager.add("tabfocus",function(e){function n(e){9!==e.keyCode||e.ctrlKey||e.altKey||e.metaKey||e.preventDefault()}function t(n){function t(n){function t(e){return"BODY"===e.nodeName||"hidden"!=e.type&&"none"!=e.style.display&&"hidden"!=e.style.visibility&&t(e.parentNode)}function r(e){return e.tabIndex||"INPUT"==e.nodeName||"TEXTAREA"==e.nodeName}function d(e){return!r(e)&&"-1"!=e.getAttribute("tabindex")&&t(e)}if(u=i.select(":input:enabled,*[tabindex]:not(iframe)"),o(u,function(n,t){return n.id==e.id?(a=t,!1):void 0}),n>0){for(c=a+1;c<u.length;c++)if(d(u[c]))return u[c]}else for(c=a-1;c>=0;c--)if(d(u[c]))return u[c];return null}var a,u,d,c;if(!(9!==n.keyCode||n.ctrlKey||n.altKey||n.metaKey||n.isDefaultPrevented())&&(d=r(e.getParam("tab_focus",e.getParam("tabfocus_elements",":prev,:next"))),1==d.length&&(d[1]=d[0],d[0]=":prev"),u=n.shiftKey?":prev"==d[0]?t(-1):i.get(d[0]):":next"==d[1]?t(1):i.get(d[1]))){var f=tinymce.get(u.id||u.name);u.id&&f?f.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),u.focus()},10),n.preventDefault()}}var i=tinymce.DOM,o=tinymce.each,r=tinymce.explode;e.on("init",function(){e.inline&&tinymce.DOM.setAttrib(e.getBody(),"tabIndex",null),e.on("keyup",n),tinymce.Env.gecko?e.on("keypress keydown",t):e.on("keydown",t)})});