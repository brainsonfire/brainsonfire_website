!function(){window.$jit=function(e){e=e||window;for(var t in $jit)$jit[t].$extend&&(e[t]=$jit[t])},$jit.version="2.0.0b";var e=function(e){return document.getElementById(e)};e.empty=function(){},e.extend=function(e,t){for(var n in t||{})e[n]=t[n];return e},e.lambda=function(e){return"function"==typeof e?e:function(){return e}},e.time=Date.now||function(){return+new Date},e.splat=function(t){var n=e.type(t);return n?"array"!=n?[t]:t:[]},e.type=function(t){var n=e.type.s.call(t).match(/^\[object\s(.*)\]$/)[1].toLowerCase();return"object"!=n?n:t&&t.$$family?t.$$family:t&&t.nodeName&&1==t.nodeType?"element":n},e.type.s=Object.prototype.toString,e.each=function(t,n){if("object"==e.type(t))for(var i in t)n(t[i],i);else{i=0;for(var o=t.length;o>i;i++)n(t[i],i)}},e.indexOf=function(e,t){if(Array.indexOf)return e.indexOf(t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},e.map=function(t,n){var i=[];return e.each(t,function(e,t){i.push(n(e,t))}),i},e.reduce=function(e,t,n){var i=e.length;if(0==i)return n;for(var o=3==arguments.length?n:e[--i];i--;)o=t(o,e[i]);return o},e.merge=function(){for(var t={},n=0,i=arguments.length;i>n;n++){var o=arguments[n];if("object"==e.type(o))for(var a in o){var s=o[a],r=t[a];t[a]=r&&"object"==e.type(s)&&"object"==e.type(r)?e.merge(r,s):e.unlink(s)}}return t},e.unlink=function(t){var n;switch(e.type(t)){case"object":n={};for(var i in t)n[i]=e.unlink(t[i]);break;case"array":n=[],i=0;for(var o=t.length;o>i;i++)n[i]=e.unlink(t[i]);break;default:return t}return n},e.zip=function(){if(0===arguments.length)return[];for(var e=0,t=[],n=arguments.length,i=arguments[0].length;i>e;e++){for(var o=0,a=[];n>o;o++)a.push(arguments[o][e]);t.push(a)}return t},e.rgbToHex=function(e,t){if(e.length<3)return null;if(4==e.length&&0==e[3]&&!t)return"transparent";for(var n=[],i=0;3>i;i++){var o=(e[i]-0).toString(16);n.push(1==o.length?"0"+o:o)}return t?n:"#"+n.join("")},e.hexToRgb=function(e){if(7!=e.length){if(e=e.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/),e.shift(),3!=e.length)return null;for(var t=[],n=0;3>n;n++){var i=e[n];1==i.length&&(i+=i),t.push(parseInt(i,16))}return t}return e=parseInt(e.slice(1),16),[e>>16,e>>8&255,255&e]},e.destroy=function(t){e.clean(t),t.parentNode&&t.parentNode.removeChild(t),t.clearAttributes&&t.clearAttributes()},e.clean=function(t){t=t.childNodes;for(var n=0,i=t.length;i>n;n++)e.destroy(t[n])},e.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},e.addEvents=function(t,n){for(var i in n)e.addEvent(t,i,n[i])},e.hasClass=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},e.addClass=function(t,n){e.hasClass(t,n)||(t.className=t.className+" "+n)},e.removeClass=function(e,t){e.className=e.className.replace(RegExp("(^|\\s)"+t+"(?:\\s|$)"),"$1")},e.getPos=function(e){var t=function(e){for(var t={x:0,y:0};e&&!/^(?:body|html)$/i.test(e.tagName);)t.x+=e.offsetLeft,t.y+=e.offsetTop,e=e.offsetParent;return t}(e);return e=function(e){for(var t={x:0,y:0};e&&!/^(?:body|html)$/i.test(e.tagName);)t.x+=e.scrollLeft,t.y+=e.scrollTop,e=e.parentNode;return t}(e),{x:t.x-e.x,y:t.y-e.y}},e.event={get:function(e,t){return t=t||window,e||t.event},getWheel:function(e){return e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3},isRightClick:function(e){return 3==e.which||2==e.button},getPos:function(e,t){t=t||window,e=e||t.event;var n=t.document;return n=n.documentElement||n.body,e.touches&&e.touches.length&&(e=e.touches[0]),{x:e.pageX||e.clientX+n.scrollLeft,y:e.pageY||e.clientY+n.scrollTop}},stop:function(e){e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1}},$jit.util=$jit.id=e;var t=function(n){n=n||{};var i,o=function(){for(var n in this)"function"!=typeof this[n]&&(this[n]=e.unlink(this[n]));return this.constructor=o,t.prototyping?this:(n=this.initialize?this.initialize.apply(this,arguments):this,this.$$family="class",n)};for(i in t.Mutators)n[i]&&(n=t.Mutators[i](n,n[i]),delete n[i]);return e.extend(o,this),o.constructor=t,o.prototype=n,o};t.Mutators={Implements:function(n,i){return e.each(e.splat(i),function(e){t.prototyping=e,e="function"==typeof e?new e:e;for(var i in e)i in n||(n[i]=e[i]);delete t.prototyping}),n}},e.extend(t,{inherit:function(n,i){for(var o in i){var a=i[o],s=n[o],r=e.type(a);s&&"function"==r?a!=s&&t.override(n,o,a):n[o]="object"==r?e.merge(s,a):a}return n},override:function(e,n,i){var o=t.prototyping;o&&e[n]!=o[n]&&(o=null),e[n]=function(){var t=this.parent;this.parent=o?o[n]:e[n];var a=i.apply(this,arguments);return this.parent=t,a}}}),t.prototype.implement=function(){var n=this.prototype;return e.each(Array.prototype.slice.call(arguments||[]),function(e){t.inherit(n,e)}),this},$jit.Class=t,$jit.json={prune:function(e,t){this.each(e,function(e,n){n==t&&e.children&&(delete e.children,e.children=[])})},getParent:function(e,t){if(e.id==t)return!1;var n=e.children;if(n&&n.length>0)for(var i=0;i<n.length;i++){if(n[i].id==t)return e;var o=this.getParent(n[i],t);if(o)return o}return!1},getSubtree:function(e,t){if(e.id==t)return e;for(var n=0,i=e.children;n<i.length;n++){var o=this.getSubtree(i[n],t);if(null!=o)return o}return null},eachLevel:function(e,t,n,i){if(n>=t&&(i(e,t),e.children)){var o=0;for(e=e.children;o<e.length;o++)this.eachLevel(e[o],t+1,n,i)}},each:function(e,t){this.eachLevel(e,0,Number.MAX_VALUE,t)}},$jit.Trans={$extend:!0,linear:function(e){return e}};var n=$jit.Trans;!function(){var t=function(t,n){return n=e.splat(n),e.extend(t,{easeIn:function(e){return t(e,n)},easeOut:function(e){return 1-t(1-e,n)},easeInOut:function(e){return.5>=e?t(2*e,n)/2:(2-t(2*(1-e),n))/2}})};e.each({Pow:function(e,t){return Math.pow(e,t[0]||6)},Expo:function(e){return Math.pow(2,8*(e-1))},Circ:function(e){return 1-Math.sin(Math.acos(e))},Sine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Back:function(e,t){return t=t[0]||1.618,Math.pow(e,2)*((t+1)*e-t)},Bounce:function(e){for(var t,n=0,i=1;;n+=i,i/=2)if(e>=(7-4*n)/11){t=i*i-Math.pow((11-6*n-11*e)/4,2);break}return t},Elastic:function(e,t){return Math.pow(2,10*--e)*Math.cos(20*e*Math.PI*(t[0]||1)/3)}},function(e,i){n[i]=t(e)}),e.each(["Quad","Cubic","Quart","Quint"],function(e,i){n[e]=t(function(e){return Math.pow(e,[i+2])})})}();var i=new t({initialize:function(e){this.setOptions(e)},setOptions:function(t){return this.opt=e.merge({duration:2500,fps:40,transition:n.Quart.easeInOut,compute:e.empty,complete:e.empty,link:"ignore"},t||{}),this},step:function(){var t=e.time(),n=this.opt;t<this.time+n.duration?(t=n.transition((t-this.time)/n.duration),n.compute(t)):(this.timer=clearInterval(this.timer),n.compute(1),n.complete())},start:function(){return this.check()?(this.time=0,this.startTimer(),this):this},startTimer:function(){var t=this,n=this.opt.fps;return this.timer?!1:(this.time=e.time()-this.time,this.timer=setInterval(function(){t.step()},Math.round(1e3/n)),!0)},pause:function(){return this.stopTimer(),this},resume:function(){return this.startTimer(),this},stopTimer:function(){return this.timer?(this.time=e.time()-this.time,this.timer=clearInterval(this.timer),!0):!1},check:function(){return this.timer?"cancel"==this.opt.link?(this.stopTimer(),!0):!1:!0}}),o=function(){for(var t=arguments,n=0,i=t.length,a={};i>n;n++){var s=o[t[n]];s.$extend?e.extend(a,s):a[t[n]]=s}return a};o.Canvas={$extend:!0,injectInto:"id",width:!1,height:!1,useCanvas:!1,withLabels:!0,background:!1},o.Tree={$extend:!0,orientation:"left",subtreeOffset:8,siblingOffset:5,indent:10,multitree:!1,align:"center"},o.Node={$extend:!1,overridable:!1,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:!1,autoWidth:!1,lineWidth:1,transform:!0,align:"center",angularWidth:1,span:1,CanvasStyles:{}},o.Edge={$extend:!1,overridable:!1,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}},o.Fx={$extend:!0,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:!0},o.Label={$extend:!1,overridable:!1,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"},o.Tips={$extend:!1,enable:!1,type:"auto",offsetX:20,offsetY:20,force:!1,onShow:e.empty,onHide:e.empty},o.Navigation={$extend:!1,enable:!1,type:"auto",panning:!1,zooming:!1},o.NodeStyles={$extend:!1,enable:!1,type:"auto",stylesHover:!1,stylesClick:!1},o.Events={$extend:!1,enable:!1,enableForEdges:!1,type:"auto",onClick:e.empty,onRightClick:e.empty,onMouseMove:e.empty,onMouseEnter:e.empty,onMouseLeave:e.empty,onDragStart:e.empty,onDragMove:e.empty,onDragCancel:e.empty,onDragEnd:e.empty,onTouchStart:e.empty,onTouchMove:e.empty,onTouchEnd:e.empty,onMouseWheel:e.empty},o.Controller={$extend:!0,onBeforeCompute:e.empty,onAfterCompute:e.empty,onCreateLabel:e.empty,onPlaceLabel:e.empty,onComplete:e.empty,onBeforePlotLine:e.empty,onAfterPlotLine:e.empty,onBeforePlotNode:e.empty,onAfterPlotNode:e.empty,request:!1};var a={initialize:function(e,t){this.viz=t,this.canvas=t.canvas,this.config=t.config[e],this.nodeTypes=t.fx.nodeTypes;var n=this.config.type;this.labelContainer=(this.dom="auto"==n?"Native"!=t.config.Label.type:"Native"!=n)&&t.labels.getLabelContainer(),this.isEnabled()&&this.initializePost()},initializePost:e.empty,setAsProperty:e.lambda(!1),isEnabled:function(){return this.config.enable},isLabel:function(t,n){t=e.event.get(t,n);var i=this.labelContainer,o=t.target||t.srcElement;return o&&o.parentNode==i?o:!1}},s={onMouseUp:e.empty,onMouseDown:e.empty,onMouseMove:e.empty,onMouseOver:e.empty,onMouseOut:e.empty,onMouseWheel:e.empty,onTouchStart:e.empty,onTouchMove:e.empty,onTouchEnd:e.empty,onTouchCancel:e.empty},r=new t({initialize:function(e){this.viz=e,this.canvas=e.canvas,this.edge=this.node=!1,this.registeredObjects=[],this.attachEvents()},attachEvents:function(){var t=this.canvas.getElement(),n=this;t.oncontextmenu=e.lambda(!1),e.addEvents(t,{mouseup:function(t,i){var o=e.event.get(t,i);n.handleEvent("MouseUp",t,i,n.makeEventObject(t,i),e.event.isRightClick(o))},mousedown:function(t,i){var o=e.event.get(t,i);n.handleEvent("MouseDown",t,i,n.makeEventObject(t,i),e.event.isRightClick(o))},mousemove:function(e,t){n.handleEvent("MouseMove",e,t,n.makeEventObject(e,t))},mouseover:function(e,t){n.handleEvent("MouseOver",e,t,n.makeEventObject(e,t))},mouseout:function(e,t){n.handleEvent("MouseOut",e,t,n.makeEventObject(e,t))},touchstart:function(e,t){n.handleEvent("TouchStart",e,t,n.makeEventObject(e,t))},touchmove:function(e,t){n.handleEvent("TouchMove",e,t,n.makeEventObject(e,t))},touchend:function(e,t){n.handleEvent("TouchEnd",e,t,n.makeEventObject(e,t))}});var i=function(t,i){var o=e.event.get(t,i);o=e.event.getWheel(o),n.handleEvent("MouseWheel",t,i,o)};document.getBoxObjectFor||null!=window.mozInnerScreenX?t.addEventListener("DOMMouseScroll",i,!1):e.addEvent(t,"mousewheel",i)},register:function(e){this.registeredObjects.push(e)},handleEvent:function(){for(var e=Array.prototype.slice.call(arguments),t=e.shift(),n=0,i=this.registeredObjects,o=i.length;o>n;n++)i[n]["on"+t].apply(i[n],e)},makeEventObject:function(t,n){var i=this,o=this.viz.graph,a=this.viz.fx,s=a.nodeTypes,r=a.edgeTypes;return{pos:!1,node:!1,edge:!1,contains:!1,getNodeCalled:!1,getEdgeCalled:!1,getPos:function(){var o=i.viz.canvas,a=o.getSize(),s=o.getPos(),r=o.translateOffsetX,h=o.translateOffsetY,c=o.scaleOffsetX;o=o.scaleOffsetY;var l=e.event.getPos(t,n);return this.pos={x:1*(l.x-s.x-a.width/2-r)/c,y:1*(l.y-s.y-a.height/2-h)/o}},getNode:function(){if(this.getNodeCalled)return this.node;this.getNodeCalled=!0;for(var e in o.nodes){var t=o.nodes[e],n=t&&s[t.getData("type")];if(n=n&&n.contains&&n.contains.call(a,t,this.getPos()))return this.contains=n,i.node=this.node=t}return i.node=this.node=!1},getEdge:function(){if(this.getEdgeCalled)return this.edge;this.getEdgeCalled=!0;var e,t={};for(e in o.edges){var n=o.edges[e];t[e]=!0;for(var s in n)if(!(s in t)){var h=n[s],c=h&&r[h.getData("type")];if(c=c&&c.contains&&c.contains.call(a,h,this.getPos()))return this.contains=c,i.edge=this.edge=h}}return i.edge=this.edge=!1},getContains:function(){return this.getNodeCalled?this.contains:(this.getNode(),this.contains)}}}}),h={initializeExtras:function(){var t=new r(this),n=this;e.each(["NodeStyles","Tips","Navigation","Events"],function(e){var i=new h.Classes[e](e,n);i.isEnabled()&&t.register(i),i.setAsProperty()&&(n[e.toLowerCase()]=i)})}};h.Classes={},h.Classes.Events=new t({Implements:[a,s],initializePost:function(){this.fx=this.viz.fx,this.ntypes=this.viz.fx.nodeTypes,this.etypes=this.viz.fx.edgeTypes,this.moved=this.touchMoved=this.touched=this.pressed=this.hovered=!1},setAsProperty:e.lambda(!0),onMouseUp:function(t,n,i,o){t=e.event.get(t,n),this.moved||(o?this.config.onRightClick(this.hovered,i,t):this.config.onClick(this.pressed,i,t)),this.pressed&&(this.moved?this.config.onDragEnd(this.pressed,i,t):this.config.onDragCancel(this.pressed,i,t),this.pressed=this.moved=!1)},onMouseOut:function(t,n,i){var o,a=e.event.get(t,n);if(this.dom&&(o=this.isLabel(t,n)))this.config.onMouseLeave(this.viz.graph.getNode(o.id),i,a),this.hovered=!1;else{for(t=a.relatedTarget,n=this.canvas.getElement();t&&t.parentNode;){if(n==t.parentNode)return;t=t.parentNode}this.hovered&&(this.config.onMouseLeave(this.hovered,i,a),this.hovered=!1)}},onMouseOver:function(t,n,i){var o,a=e.event.get(t,n);this.dom&&(o=this.isLabel(t,n))&&(this.hovered=this.viz.graph.getNode(o.id),this.config.onMouseEnter(this.hovered,i,a))},onMouseMove:function(t,n,i){if(t=e.event.get(t,n),this.pressed)this.moved=!0,this.config.onDragMove(this.pressed,i,t);else if(this.dom)this.config.onMouseMove(this.hovered,i,t);else{if(this.hovered){n=this.hovered;var o=n.nodeFrom?this.etypes[n.getData("type")]:this.ntypes[n.getData("type")];if(o&&o.contains&&o.contains.call(this.fx,n,i.getPos()))return this.config.onMouseMove(n,i,t),void 0;this.config.onMouseLeave(n,i,t),this.hovered=!1}(this.hovered=i.getNode()||this.config.enableForEdges&&i.getEdge())?this.config.onMouseEnter(this.hovered,i,t):this.config.onMouseMove(!1,i,t)}},onMouseWheel:function(t,n,i){this.config.onMouseWheel(i,e.event.get(t,n))},onMouseDown:function(t,n,i){t=e.event.get(t,n),this.pressed=i.getNode()||this.config.enableForEdges&&i.getEdge(),this.config.onDragStart(this.pressed,i,t)},onTouchStart:function(t,n,i){t=e.event.get(t,n),this.touched=i.getNode()||this.config.enableForEdges&&i.getEdge(),this.config.onTouchStart(this.touched,i,t)},onTouchMove:function(t,n,i){t=e.event.get(t,n),this.touched&&(this.touchMoved=!0,this.config.onTouchMove(this.touched,i,t))},onTouchEnd:function(t,n,i){t=e.event.get(t,n),this.touched&&(this.touchMoved?this.config.onTouchEnd(this.touched,i,t):this.config.onTouchCancel(this.touched,i,t),this.touched=this.touchMoved=!1)}}),h.Classes.Tips=new t({Implements:[a,s],initializePost:function(){if(document.body){var t=e("_tooltip")||document.createElement("div");t.id="_tooltip",t.className="tip",e.extend(t.style,{position:"absolute",display:"none",zIndex:13e3}),document.body.appendChild(t),this.tip=t,this.node=!1}},setAsProperty:e.lambda(!0),onMouseOut:function(e,t){if(this.dom&&this.isLabel(e,t))this.hide(!0);else{for(var n=e.relatedTarget,i=this.canvas.getElement();n&&n.parentNode;){if(i==n.parentNode)return;n=n.parentNode}this.hide(!1)}},onMouseOver:function(e,t){var n;this.dom&&(n=this.isLabel(e,t))&&(this.node=this.viz.graph.getNode(n.id),this.config.onShow(this.tip,this.node,n))},onMouseMove:function(t,n,i){if(this.dom&&this.isLabel(t,n)&&this.setTooltipPosition(e.event.getPos(t,n)),!this.dom){var o=i.getNode();o?((this.config.force||!this.node||this.node.id!=o.id)&&(this.node=o,this.config.onShow(this.tip,o,i.getContains())),this.setTooltipPosition(e.event.getPos(t,n))):this.hide(!0)}},setTooltipPosition:function(e){var t=this.tip,n=t.style,i=this.config;n.display="";var o={height:document.body.clientHeight,width:document.body.clientWidth};t={width:t.offsetWidth,height:t.offsetHeight};var a=i.offsetX;i=i.offsetY,n.top=(e.y+i+t.height>o.height?e.y-t.height-i:e.y+i)+"px",n.left=(e.x+t.width+a>o.width?e.x-t.width-a:e.x+a)+"px"},hide:function(e){this.tip.style.display="none",e&&this.config.onHide()}}),h.Classes.NodeStyles=new t({Implements:[a,s],initializePost:function(){this.fx=this.viz.fx,this.types=this.viz.fx.nodeTypes,this.nStyles=this.config,this.nodeStylesOnHover=this.nStyles.stylesHover,this.nodeStylesOnClick=this.nStyles.stylesClick,this.hoveredNode=!1,this.fx.nodeFxAnimation=new i,this.move=this.down=!1},onMouseOut:function(e,t){if(this.down=this.move=!1,this.hoveredNode){this.dom&&this.isLabel(e,t)&&this.toggleStylesOnHover(this.hoveredNode,!1);for(var n=e.relatedTarget,i=this.canvas.getElement();n&&n.parentNode;){if(i==n.parentNode)return;n=n.parentNode}this.toggleStylesOnHover(this.hoveredNode,!1),this.hoveredNode=!1}},onMouseOver:function(e,t){var n;this.dom&&(n=this.isLabel(e,t))&&(n=this.viz.graph.getNode(n.id),n.selected||(this.hoveredNode=n,this.toggleStylesOnHover(this.hoveredNode,!0)))},onMouseDown:function(e,t,n,i){if(!i){var o;this.dom&&(o=this.isLabel(e,t))?this.down=this.viz.graph.getNode(o.id):this.dom||(this.down=n.getNode()),this.move=!1}},onMouseUp:function(e,t,n,i){i||(this.move||this.onClick(n.getNode()),this.down=this.move=!1)},getRestoredStyles:function(e,t){var n,i={},o=this["nodeStylesOn"+t];for(n in o)i[n]=e.styles["$"+n];return i},toggleStylesOnHover:function(e,t){this.nodeStylesOnHover&&this.toggleStylesOn("Hover",e,t)},toggleStylesOnClick:function(e,t){this.nodeStylesOnClick&&this.toggleStylesOn("Click",e,t)},toggleStylesOn:function(t,i,o){var a=this.viz;if(o){i.styles||(i.styles=e.merge(i.data,{}));for(var s in this["nodeStylesOn"+t])o="$"+s,o in i.styles||(i.styles[o]=i.getData(s));a.fx.nodeFx(e.extend({elements:{id:i.id,properties:this["nodeStylesOn"+t]},transition:n.Quart.easeOut,duration:300,fps:40},this.config))}else t=this.getRestoredStyles(i,t),a.fx.nodeFx(e.extend({elements:{id:i.id,properties:t},transition:n.Quart.easeOut,duration:300,fps:40},this.config))},onClick:function(e){if(e){var t=this.nodeStylesOnClick;t&&(e.selected?(this.toggleStylesOnClick(e,!1),delete e.selected):(this.viz.graph.eachNode(function(e){if(e.selected){for(var n in t)e.setData(n,e.styles["$"+n],"end");delete e.selected}}),this.toggleStylesOnClick(e,!0),e.selected=!0,delete e.hovered,this.hoveredNode=!1))}},onMouseMove:function(e,t,n){if(this.down&&(this.move=!0),!this.dom||!this.isLabel(e,t)){var i=this.nodeStylesOnHover;if(i&&!this.dom){if(this.hoveredNode&&(e=this.types[this.hoveredNode.getData("type")])&&e.contains&&e.contains.call(this.fx,this.hoveredNode,n.getPos()))return;n=n.getNode(),(this.hoveredNode||n)&&(n.hovered||(n&&!n.selected?(this.fx.nodeFxAnimation.stopTimer(),this.viz.graph.eachNode(function(e){if(e.hovered&&!e.selected){for(var t in i)e.setData(t,e.styles["$"+t],"end");delete e.hovered}}),n.hovered=!0,this.hoveredNode=n,this.toggleStylesOnHover(n,!0)):this.hoveredNode&&!this.hoveredNode.selected&&(this.fx.nodeFxAnimation.stopTimer(),this.toggleStylesOnHover(this.hoveredNode,!1),delete this.hoveredNode.hovered,this.hoveredNode=!1)))}}}}),h.Classes.Navigation=new t({Implements:[a,s],initializePost:function(){this.pressed=this.pos=!1},onMouseWheel:function(t,n,i){this.config.zooming&&(e.event.stop(e.event.get(t,n)),t=1+i*(this.config.zooming/1e3),this.canvas.scale(t,t))},onMouseDown:function(e,t,n){if(this.config.panning&&("avoid nodes"!=this.config.panning||!n.getNode())){this.pressed=!0,this.pos=n.getPos(),e=this.canvas,t=e.translateOffsetX,n=e.translateOffsetY;var i=e.scaleOffsetY;this.pos.x*=e.scaleOffsetX,this.pos.x+=t,this.pos.y*=i,this.pos.y+=n}},onMouseMove:function(e,t,n){if(this.config.panning&&this.pressed&&("avoid nodes"!=this.config.panning||!n.getNode())){e=this.pos,n=n.getPos();var i=this.canvas,o=i.translateOffsetX,a=i.translateOffsetY;t=i.scaleOffsetX,i=i.scaleOffsetY,n.x*=t,n.y*=i,n.x+=o,n.y+=a,o=n.x-e.x,e=n.y-e.y,this.pos=n,this.canvas.translate(1*o/t,1*e/i)}},onMouseUp:function(){this.config.panning&&(this.pressed=!1)}});var c;!function(){function n(t,n){var i,a=document.createElement(t);for(i in n)"object"==typeof n[i]?e.extend(a[i],n[i]):a[i]=n[i];return"canvas"==t&&!o&&G_vmlCanvasManager&&(a=G_vmlCanvasManager.initElement(document.body.appendChild(a))),a}var i=typeof HTMLCanvasElement,o="object"==i||"function"==i;$jit.Canvas=c=new t({canvases:[],pos:!1,element:!1,labelContainer:!1,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(t,i){this.viz=t,this.opt=i;var o="string"==e.type(i.injectInto)?i.injectInto:i.injectInto.id,a=o+"-label",s=e(o),r=i.width||s.offsetWidth,h=i.height||s.offsetHeight;this.id=o;var l={injectInto:o,width:r,height:h};for(this.element=n("div",{id:o+"-canvaswidget",style:{position:"relative",width:r+"px",height:h+"px"}}),this.labelContainer=this.createLabelContainer(i.Label.type,a,l),this.canvases.push(new c.Base({config:e.extend({idSuffix:"-canvas"},l),plot:function(){t.fx.plot()},resize:function(){t.refresh()}})),(o=i.background)&&(l=new c.Background[o.type](t,e.extend(o,l)),this.canvases.push(new c.Base(l))),l=this.canvases.length;l--;)this.element.appendChild(this.canvases[l].canvas),l>0&&this.canvases[l].plot();this.element.appendChild(this.labelContainer),s.appendChild(this.element);var d=null,u=this;e.addEvent(window,"scroll",function(){clearTimeout(d),d=setTimeout(function(){u.getPos(!0)},500)})},getCtx:function(e){return this.canvases[e||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(e){return this.canvases[e||0].getSize()},resize:function(e,t){this.getPos(!0),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1;for(var n=0,i=this.canvases.length;i>n;n++)this.canvases[n].resize(e,t);n=this.element.style,n.width=e+"px",n.height=t+"px",this.labelContainer&&(this.labelContainer.style.width=e+"px")},translate:function(e,t,n){this.translateOffsetX+=e*this.scaleOffsetX,this.translateOffsetY+=t*this.scaleOffsetY;for(var i=0,o=this.canvases.length;o>i;i++)this.canvases[i].translate(e,t,n)},scale:function(e,t){var n=this.scaleOffsetX*e,i=this.scaleOffsetY*t,o=this.translateOffsetX*(e-1)/n,a=this.translateOffsetY*(t-1)/i;for(this.scaleOffsetX=n,this.scaleOffsetY=i,n=0,i=this.canvases.length;i>n;n++)this.canvases[n].scale(e,t,!0);this.translate(o,a,!1)},getPos:function(t){return t||!this.pos?this.pos=e.getPos(this.getElement()):this.pos},clear:function(e){this.canvases[e||0].clear()},path:function(e,t){var n=this.canvases[0].getCtx();n.beginPath(),t(n),n[e](),n.closePath()},createLabelContainer:function(e,t,i){if("HTML"==e||"Native"==e)return n("div",{id:t,style:{overflow:"visible",position:"absolute",top:0,left:0,width:i.width+"px",height:0}});if("SVG"==e){e=document.createElementNS("http://www.w3.org/2000/svg","svg:svg"),e.setAttribute("width",i.width),e.setAttribute("height",i.height);var o=e.style;return o.position="absolute",o.left=o.top="0px",o=document.createElementNS("http://www.w3.org/2000/svg","svg:g"),o.setAttribute("width",i.width),o.setAttribute("height",i.height),o.setAttribute("x",0),o.setAttribute("y",0),o.setAttribute("id",t),e.appendChild(o),e}}}),c.Base=new t({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(e){this.viz=e,this.opt=e.config,this.size=!1,this.createCanvas(),this.translateToCenter()},createCanvas:function(){var e=this.opt,t=e.width,i=e.height;this.canvas=n("canvas",{id:e.injectInto+e.idSuffix,width:t,height:i,style:{position:"absolute",top:0,left:0,width:t+"px",height:i+"px"}})},getCtx:function(){return this.ctx?this.ctx:this.ctx=this.canvas.getContext("2d")},getSize:function(){if(this.size)return this.size;var e=this.canvas;return this.size={width:e.width,height:e.height}},translateToCenter:function(e){var t=this.getSize(),n=e?t.width-e.width-2*this.translateOffsetX:t.width;height=e?t.height-e.height-2*this.translateOffsetY:t.height,t=this.getCtx(),e&&t.scale(1/this.scaleOffsetX,1/this.scaleOffsetY),t.translate(n/2,height/2)},resize:function(e,t){var n=this.getSize(),i=this.canvas,a=i.style;this.size=!1,i.width=e,i.height=t,a.width=e+"px",a.height=t+"px",o?this.translateToCenter():this.translateToCenter(n),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1,this.clear(),this.viz.resize(e,t,this)},translate:function(e,t,n){var i=this.scaleOffsetY;this.translateOffsetX+=e*this.scaleOffsetX,this.translateOffsetY+=t*i,this.getCtx().translate(e,t),!n&&this.plot()},scale:function(e,t,n){this.scaleOffsetX*=e,this.scaleOffsetY*=t,this.getCtx().scale(e,t),!n&&this.plot()},clear:function(){var e=this.getSize(),t=this.translateOffsetX,n=this.translateOffsetY,i=this.scaleOffsetX,o=this.scaleOffsetY;this.getCtx().clearRect(1*(-e.width/2-t)/i,1*(-e.height/2-n)/o,1*e.width/i,1*e.height/o)},plot:function(){this.clear(),this.viz.plot(this)}}),c.Background={},c.Background.Circles=new t({initialize:function(t,n){this.viz=t,this.config=e.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},n)},resize:function(e,t,n){this.plot(n)},plot:function(e){e=e.getCtx();var t,n=this.config,i=n.CanvasStyles;for(t in i)e[t]=i[t];for(t=n.numberOfCircles,n=n.levelDistance,i=1;t>=i;i++)e.beginPath(),e.arc(0,0,n*i,0,2*Math.PI,!1),e.stroke(),e.closePath()}})}();var l=function(e,t){this.theta=e,this.rho=t};$jit.Polar=l,l.prototype={getc:function(e){return this.toComplex(e)},getp:function(){return this},set:function(e){e=e.getp(),this.theta=e.theta,this.rho=e.rho},setc:function(e,t){this.rho=Math.sqrt(e*e+t*t),this.theta=Math.atan2(t,e),this.theta<0&&(this.theta+=2*Math.PI)},setp:function(e,t){this.theta=e,this.rho=t},clone:function(){return new l(this.theta,this.rho)},toComplex:function(e){var t=Math.cos(this.theta)*this.rho,n=Math.sin(this.theta)*this.rho;return e?{x:t,y:n}:new d(t,n)},add:function(e){return new l(this.theta+e.theta,this.rho+e.rho)},scale:function(e){return new l(this.theta,this.rho*e)},equals:function(e){return this.theta==e.theta&&this.rho==e.rho},$add:function(e){return this.theta+=e.theta,this.rho+=e.rho,this},$madd:function(e){return this.theta=(this.theta+e.theta)%(2*Math.PI),this.rho+=e.rho,this},$scale:function(e){return this.rho*=e,this},interpolate:function(e,t){var n=Math.PI,i=2*n,o=function(e){return 0>e?e%i+i:e%i},a=this.theta,s=e.theta,r=Math.abs(a-s);return{theta:r==n?a>s?o(s+(a-i-s)*t):o(s-i+(a-s)*t):r>=n?a>s?o(s+(a-i-s)*t):o(s-i+(a-(s-i))*t):o(s+(a-s)*t),rho:(this.rho-e.rho)*t+e.rho}}},l.KER=new l(0,0);var d=function(e,t){this.x=e,this.y=t};$jit.Complex=d,d.prototype={getc:function(){return this},getp:function(e){return this.toPolar(e)},set:function(e){e=e.getc(!0),this.x=e.x,this.y=e.y},setc:function(e,t){this.x=e,this.y=t},setp:function(e,t){this.x=Math.cos(e)*t,this.y=Math.sin(e)*t},clone:function(){return new d(this.x,this.y)},toPolar:function(e){var t=this.norm(),n=Math.atan2(this.y,this.x);return 0>n&&(n+=2*Math.PI),e?{theta:n,rho:t}:new l(n,t)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(e){return new d(this.x+e.x,this.y+e.y)},prod:function(e){return new d(this.x*e.x-this.y*e.y,this.y*e.x+this.x*e.y)},conjugate:function(){return new d(this.x,-this.y)},scale:function(e){return new d(this.x*e,this.y*e)},equals:function(e){return this.x==e.x&&this.y==e.y},$add:function(e){return this.x+=e.x,this.y+=e.y,this},$prod:function(e){var t=this.x,n=this.y;return this.x=t*e.x-n*e.y,this.y=n*e.x+t*e.y,this},$conjugate:function(){return this.y=-this.y,this},$scale:function(e){return this.x*=e,this.y*=e,this},$div:function(e){var t=this.x,n=this.y,i=e.squaredNorm();return this.x=t*e.x+n*e.y,this.y=n*e.x-t*e.y,this.$scale(1/i)}},d.KER=new d(0,0),$jit.Graph=new t({initialize:function(t,n,i,o){this.Node=n,this.Edge=i,this.Label=o,this.opt=e.merge({complex:!1,Node:{}},t||{}),this.nodes={},this.edges={};var a=this;this.nodeList={};for(var s in u)a.nodeList[s]=function(e){return function(){var t=Array.prototype.slice.call(arguments);a.eachNode(function(n){n[e].apply(n,t)})}}(s)},getNode:function(e){return this.hasNode(e)?this.nodes[e]:!1},getByName:function(e){for(var t in this.nodes){var n=this.nodes[t];if(n.name==e)return n}return!1},getAdjacence:function(e,t){return e in this.edges?this.edges[e][t]:!1},addNode:function(t){if(!this.nodes[t.id]){var n=this.edges[t.id]={};this.nodes[t.id]=new f.Node(e.extend({id:t.id,name:t.name,data:e.merge(t.data||{},{}),adjacencies:n},this.opt.Node),this.opt.complex,this.Node,this.Edge,this.Label)}return this.nodes[t.id]},addAdjacence:function(e,t,n){if(this.hasNode(e.id)||this.addNode(e),this.hasNode(t.id)||this.addNode(t),e=this.nodes[e.id],t=this.nodes[t.id],!e.adjacentTo(t)){var i=this.edges[e.id]=this.edges[e.id]||{},o=this.edges[t.id]=this.edges[t.id]||{};return i[t.id]=o[e.id]=new f.Adjacence(e,t,n,this.Edge,this.Label),i[t.id]}return this.edges[e.id][t.id]},removeNode:function(e){if(this.hasNode(e)){delete this.nodes[e];var t,n=this.edges[e];for(t in n)delete this.edges[t][e];delete this.edges[e]}},removeAdjacence:function(e,t){delete this.edges[e][t],delete this.edges[t][e]},hasNode:function(e){return e in this.nodes},empty:function(){this.nodes={},this.edges={}}});var u,f=$jit.Graph;!function(){var t=function(e,t,n,i,o){var a;return n=n||"current",e="$"+(e?e+"-":""),"current"==n?a=this.data:"start"==n?a=this.startData:"end"==n&&(a=this.endData),e+=t,i?a[e]:this.Config.overridable?e in a?a[e]:e in this.data?this.data[e]:o[t]||0:o[t]||0},n=function(e,t,n,i){i=i||"current",e="$"+(e?e+"-":"");var o;"current"==i?o=this.data:"start"==i?o=this.startData:"end"==i&&(o=this.endData),o[e+t]=n},i=function(t,n){t="$"+(t?t+"-":"");var i=this;e.each(n,function(e){e=t+e,delete i.data[e],delete i.endData[e],delete i.startData[e]})};u={getData:function(e,n,i){return t.call(this,"",e,n,i,this.Config)},setData:function(e,t,i){n.call(this,"",e,t,i)},setDataset:function(t,n){t=e.splat(t);for(var i in n)for(var o=0,a=e.splat(n[i]),s=t.length;s>o;o++)this.setData(i,a[o],t[o])},removeData:function(){i.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(e,n,i){return t.call(this,"canvas",e,n,i,this.Config.CanvasStyles)},setCanvasStyle:function(e,t,i){n.call(this,"canvas",e,t,i)},setCanvasStyles:function(t,n){t=e.splat(t);for(var i in n)for(var o=0,a=e.splat(n[i]),s=t.length;s>o;o++)this.setCanvasStyle(i,a[o],t[o])},removeCanvasStyle:function(){i.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(e,n,i){return t.call(this,"label",e,n,i,this.Label)},setLabelData:function(e,t,i){n.call(this,"label",e,t,i)},setLabelDataset:function(t,n){t=e.splat(t);for(var i in n)for(var o=0,a=e.splat(n[i]),s=t.length;s>o;o++)this.setLabelData(i,a[o],t[o])},removeLabelData:function(){i.call(this,"label",Array.prototype.slice.call(arguments))}}}(),f.Node=new t({initialize:function(t,n,i,o,a){n={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:!1,drawn:!1,exist:!1,angleSpan:{begin:0,end:0},pos:n&&new d(0,0)||new l(0,0),startPos:n&&new d(0,0)||new l(0,0),endPos:n&&new d(0,0)||new l(0,0)},e.extend(this,e.extend(n,t)),this.Config=this.Node=i,this.Edge=o,this.Label=a},adjacentTo:function(e){return e.id in this.adjacencies},getAdjacency:function(e){return this.adjacencies[e]},getPos:function(e){return e=e||"current","current"==e?this.pos:"end"==e?this.endPos:"start"==e?this.startPos:void 0},setPos:function(e,t){t=t||"current";var n;"current"==t?n=this.pos:"end"==t?n=this.endPos:"start"==t&&(n=this.startPos),n.set(e)}}),f.Node.implement(u),f.Adjacence=new t({initialize:function(e,t,n,i,o){this.nodeFrom=e,this.nodeTo=t,this.data=n||{},this.startData={},this.endData={},this.Config=this.Edge=i,this.Label=o}}),f.Adjacence.implement(u),f.Util={filter:function(t){if(!t||"string"!=e.type(t))return function(){return!0};var n=t.split(" ");return function(e){for(var t=0;t<n.length;t++)if(e[n[t]])return!1;return!0}},getNode:function(e,t){return e.nodes[t]},eachNode:function(e,t,n){n=this.filter(n);for(var i in e.nodes)n(e.nodes[i])&&t(e.nodes[i])
},eachAdjacency:function(e,t,n){var i=e.adjacencies;n=this.filter(n);for(var o in i){var a=i[o];if(n(a)){if(a.nodeFrom!=e){var s=a.nodeFrom;a.nodeFrom=a.nodeTo,a.nodeTo=s}t(a,o)}}},computeLevels:function(e,t,n,i){n=n||0;var o=this.filter(i);this.eachNode(e,function(e){e._flag=!1,e._depth=-1},i),e=e.getNode(t),e._depth=n;for(var a=[e];0!=a.length;){var s=a.pop();s._flag=!0,this.eachAdjacency(s,function(e){e=e.nodeTo,0==e._flag&&o(e)&&(e._depth<0&&(e._depth=s._depth+1+n),a.unshift(e))},i)}},eachBFS:function(e,t,n,i){var o=this.filter(i);this.clean(e);for(var a=[e.getNode(t)];0!=a.length;)e=a.pop(),e._flag=!0,n(e,e._depth),this.eachAdjacency(e,function(e){e=e.nodeTo,0==e._flag&&o(e)&&(e._flag=!0,a.unshift(e))},i)},eachLevel:function(e,t,n,i,o){var a=e._depth,s=this.filter(o),r=this;n=n===!1?Number.MAX_VALUE-a:n,function h(e,t,n){var o=e._depth;o>=t&&n>=o&&s(e)&&i(e,o),n>o&&r.eachAdjacency(e,function(e){e=e.nodeTo,e._depth>o&&h(e,t,n)})}(e,t+a,n+a)},eachSubgraph:function(e,t,n){this.eachLevel(e,0,!1,t,n)},eachSubnode:function(e,t,n){this.eachLevel(e,1,1,t,n)},anySubnode:function(t,n,i){var o=!1;n=n||e.lambda(!0);var a="string"==e.type(n)?function(e){return e[n]}:n;return this.eachSubnode(t,function(e){a(e)&&(o=!0)},i),o},getSubnodes:function(t,n,i){var o=[];n=n||0;var a;return"array"==e.type(n)?(a=n[0],n=n[1]):(a=n,n=Number.MAX_VALUE-t._depth),this.eachLevel(t,a,n,function(e){o.push(e)},i),o},getParents:function(e){var t=[];return this.eachAdjacency(e,function(n){n=n.nodeTo,n._depth<e._depth&&t.push(n)}),t},isDescendantOf:function(e,t){if(e.id==t)return!0;for(var n=this.getParents(e),i=!1,o=0;!i&&o<n.length;o++)i=i||this.isDescendantOf(n[o],t);return i},clean:function(e){this.eachNode(e,function(e){e._flag=!1})},getClosestNodeToOrigin:function(e,t,n){return this.getClosestNodeToPos(e,l.KER,t,n)},getClosestNodeToPos:function(e,t,n,i){var o=null;n=n||"current",t=t&&t.getc(!0)||d.KER;var a=function(e,t){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i};return this.eachNode(e,function(e){o=null==o||a(e.getPos(n).getc(!0),t)<a(o.getPos(n).getc(!0),t)?e:o},i),o}},e.each(["getNode","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(e){f.prototype[e]=function(){return f.Util[e].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),e.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(e){f.Node.prototype[e]=function(){return f.Util[e].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),f.Op={options:{type:"nothing",duration:2e3,hideLabels:!0,fps:30},initialize:function(e){this.viz=e},removeNode:function(t,n){var i,o,a,s=this.viz,r=e.merge(this.options,s.controller,n),h=e.splat(t);switch(r.type){case"nothing":for(i=0;i<h.length;i++)s.graph.removeNode(h[i]);break;case"replot":this.removeNode(h,{type:"nothing"}),s.labels.clearLabels(),s.refresh(!0);break;case"fade:seq":case"fade":for(o=this,i=0;i<h.length;i++)a=s.graph.getNode(h[i]),a.setData("alpha",0,"end");s.fx.animate(e.merge(r,{modes:["node-property:alpha"],onComplete:function(){o.removeNode(h,{type:"nothing"}),s.labels.clearLabels(),s.reposition(),s.fx.animate(e.merge(r,{modes:["linear"]}))}}));break;case"fade:con":for(o=this,i=0;i<h.length;i++)a=s.graph.getNode(h[i]),a.setData("alpha",0,"end"),a.ignore=!0;s.reposition(),s.fx.animate(e.merge(r,{modes:["node-property:alpha","linear"],onComplete:function(){o.removeNode(h,{type:"nothing"})}}));break;case"iter":o=this,s.fx.sequence({condition:function(){return 0!=h.length},step:function(){o.removeNode(h.shift(),{type:"nothing"}),s.labels.clearLabels()},onComplete:function(){r.onComplete()},duration:Math.ceil(r.duration/h.length)});break;default:this.doError()}},removeEdge:function(t,n){var i,o,a,s=this.viz,r=e.merge(this.options,s.controller,n),h="string"==e.type(t[0])?[t]:t;switch(r.type){case"nothing":for(i=0;i<h.length;i++)s.graph.removeAdjacence(h[i][0],h[i][1]);break;case"replot":this.removeEdge(h,{type:"nothing"}),s.refresh(!0);break;case"fade:seq":case"fade":for(o=this,i=0;i<h.length;i++)(a=s.graph.getAdjacence(h[i][0],h[i][1]))&&a.setData("alpha",0,"end");s.fx.animate(e.merge(r,{modes:["edge-property:alpha"],onComplete:function(){o.removeEdge(h,{type:"nothing"}),s.reposition(),s.fx.animate(e.merge(r,{modes:["linear"]}))}}));break;case"fade:con":for(o=this,i=0;i<h.length;i++)(a=s.graph.getAdjacence(h[i][0],h[i][1]))&&(a.setData("alpha",0,"end"),a.ignore=!0);s.reposition(),s.fx.animate(e.merge(r,{modes:["edge-property:alpha","linear"],onComplete:function(){o.removeEdge(h,{type:"nothing"})}}));break;case"iter":o=this,s.fx.sequence({condition:function(){return 0!=h.length},step:function(){o.removeEdge(h.shift(),{type:"nothing"}),s.labels.clearLabels()},onComplete:function(){r.onComplete()},duration:Math.ceil(r.duration/h.length)});break;default:this.doError()}},sum:function(t,n){var i,o=this.viz,a=e.merge(this.options,o.controller,n),s=o.root;switch(o.root=n.id||o.root,a.type){case"nothing":i=o.construct(t),i.eachNode(function(e){e.eachAdjacency(function(e){o.graph.addAdjacence(e.nodeFrom,e.nodeTo,e.data)})});break;case"replot":o.refresh(!0),this.sum(t,{type:"nothing"}),o.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,i=o.construct(t);var r=this.preprocessSum(i)?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];o.reposition(),"fade:con"!=a.type?o.fx.animate(e.merge(a,{modes:["linear"],onComplete:function(){o.fx.animate(e.merge(a,{modes:r,onComplete:function(){a.onComplete()}}))}})):(o.graph.eachNode(function(e){e.id!=s&&e.pos.getp().equals(l.KER)&&(e.pos.set(e.endPos),e.startPos.set(e.endPos))}),o.fx.animate(e.merge(a,{modes:["linear"].concat(r)})));break;default:this.doError()}},morph:function(t,n,i){var o,a=this.viz,s=e.merge(this.options,a.controller,n),r=a.root;switch(a.root=n.id||a.root,s.type){case"nothing":o=a.construct(t),o.eachNode(function(e){var t=a.graph.hasNode(e.id);if(e.eachAdjacency(function(e){var t=!!a.graph.getAdjacence(e.nodeFrom.id,e.nodeTo.id);if(a.graph.addAdjacence(e.nodeFrom,e.nodeTo,e.data),t){t=a.graph.getAdjacence(e.nodeFrom.id,e.nodeTo.id);for(var n in e.data||{})t.data[n]=e.data[n]}}),t){t=a.graph.getNode(e.id);for(var n in e.data||{})t.data[n]=e.data[n]}}),a.graph.eachNode(function(e){e.eachAdjacency(function(e){o.getAdjacence(e.nodeFrom.id,e.nodeTo.id)||a.graph.removeAdjacence(e.nodeFrom.id,e.nodeTo.id)}),o.hasNode(e.id)||a.graph.removeNode(e.id)});break;case"replot":a.labels.clearLabels(!0),this.morph(t,{type:"nothing"}),a.refresh(!0),a.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,o=a.construct(t);var h=i&&"node-property"in i&&e.map(e.splat(i["node-property"]),function(e){return"$"+e});a.graph.eachNode(function(t){var n=o.getNode(t.id);if(n){n=n.data;for(var i in n)h&&e.indexOf(h,i)>-1?t.endData[i]=n[i]:t.data[i]=n[i]}else t.setData("alpha",1),t.setData("alpha",1,"start"),t.setData("alpha",0,"end"),t.ignore=!0}),a.graph.eachNode(function(e){e.ignore||e.eachAdjacency(function(e){if(!e.nodeFrom.ignore&&!e.nodeTo.ignore){var t=o.getNode(e.nodeFrom.id);e=o.getNode(e.nodeTo.id),t.adjacentTo(e)||(e=a.graph.getAdjacence(t.id,e.id),c=!0,e.setData("alpha",1),e.setData("alpha",1,"start"),e.setData("alpha",0,"end"))}})});var c=this.preprocessSum(o);t=c?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"],t[0]+=i&&"node-property"in i?":"+e.splat(i["node-property"]).join(":"):"",t[1]=(t[1]||"edge-property:alpha")+(i&&"edge-property"in i?":"+e.splat(i["edge-property"]).join(":"):""),i&&"label-property"in i&&t.push("label-property:"+e.splat(i["label-property"]).join(":")),a.reposition(),a.graph.eachNode(function(e){e.id!=r&&e.pos.getp().equals(l.KER)&&(e.pos.set(e.endPos),e.startPos.set(e.endPos))}),a.fx.animate(e.merge(s,{modes:["polar"].concat(t),onComplete:function(){a.graph.eachNode(function(e){e.ignore&&a.graph.removeNode(e.id)}),a.graph.eachNode(function(e){e.eachAdjacency(function(e){e.ignore&&a.graph.removeAdjacence(e.nodeFrom.id,e.nodeTo.id)})}),s.onComplete()}}))}},contract:function(t,n){var i=this.viz;!t.collapsed&&t.anySubnode(e.lambda(!0))&&(n=e.merge(this.options,i.config,n||{},{modes:["node-property:alpha:span","linear"]}),t.collapsed=!0,function o(e){e.eachSubnode(function(e){e.ignore=!0,e.setData("alpha",0,"animate"==n.type?"end":"current"),o(e)})}(t),"animate"==n.type?(i.compute("end"),i.rotated&&i.rotate(i.rotated,"none",{property:"end"}),function a(e){e.eachSubnode(function(e){e.setPos(t.getPos("end"),"end"),a(e)})}(t),i.fx.animate(n)):"replot"==n.type&&i.refresh())},expand:function(t,n){if("collapsed"in t){var i=this.viz;n=e.merge(this.options,i.config,n||{},{modes:["node-property:alpha:span","linear"]}),delete t.collapsed,function o(e){e.eachSubnode(function(e){delete e.ignore,e.setData("alpha",1,"animate"==n.type?"end":"current"),o(e)})}(t),"animate"==n.type?(i.compute("end"),i.rotated&&i.rotate(i.rotated,"none",{property:"end"}),i.fx.animate(n)):"replot"==n.type&&i.refresh()}},preprocessSum:function(e){var t=this.viz;e.eachNode(function(e){t.graph.hasNode(e.id)||(t.graph.addNode(e),e=t.graph.getNode(e.id),e.setData("alpha",0),e.setData("alpha",0,"start"),e.setData("alpha",1,"end"))});var n=!1;return e.eachNode(function(e){e.eachAdjacency(function(e){var i=t.graph.getNode(e.nodeFrom.id),o=t.graph.getNode(e.nodeTo.id);i.adjacentTo(o)||(e=t.graph.addAdjacence(i,o,e.data),i.startAlpha==i.endAlpha&&o.startAlpha==o.endAlpha&&(n=!0,e.setData("alpha",0),e.setData("alpha",0,"start"),e.setData("alpha",1,"end")))})}),n}};var p={none:{render:e.empty,contains:e.lambda(!1)},circle:{render:function(e,t,n,i){i=i.getCtx(),i.beginPath(),i.arc(t.x,t.y,n,0,2*Math.PI,!0),i.closePath(),i[e]()},contains:function(e,t,n){var i=e.x-t.x;return e=e.y-t.y,n*n>=i*i+e*e}},ellipse:{render:function(e,t,n,i,o){o=o.getCtx(),i/=2,n/=2,o.save(),o.scale(n/i,i/n),o.beginPath(),o.arc(t.x*(i/n),t.y*(n/i),i,0,2*Math.PI,!0),o.closePath(),o[e](),o.restore()},contains:function(e,t,n,i){return n/=2,i/=2,n=(n+i)/2,i=e.x-t.x,e=e.y-t.y,n*n>=i*i+e*e}},square:{render:function(e,t,n,i){i.getCtx()[e+"Rect"](t.x-n,t.y-n,2*n,2*n)},contains:function(e,t,n){return Math.abs(t.x-e.x)<=n&&Math.abs(t.y-e.y)<=n}},rectangle:{render:function(e,t,n,i,o){o.getCtx()[e+"Rect"](t.x-n/2,t.y-i/2,n,i)},contains:function(e,t,n,i){return Math.abs(t.x-e.x)<=n/2&&Math.abs(t.y-e.y)<=i/2}},triangle:{render:function(e,t,n,i){i=i.getCtx();var o=t.x,a=t.y-n,s=o-n;t=t.y+n,n=o+n,i.beginPath(),i.moveTo(o,a),i.lineTo(s,t),i.lineTo(n,t),i.closePath(),i[e]()},contains:function(e,t,n){return p.circle.contains(e,t,n)}},star:{render:function(e,t,n,i){i=i.getCtx();var o=Math.PI/5;for(i.save(),i.translate(t.x,t.y),i.beginPath(),i.moveTo(n,0),t=0;9>t;t++)i.rotate(o),t%2==0?i.lineTo(n/.525731*.200811,0):i.lineTo(n,0);i.closePath(),i[e](),i.restore()},contains:function(e,t,n){return p.circle.contains(e,t,n)}}},g={line:{render:function(e,t,n){n=n.getCtx(),n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke()},contains:function(e,t,n,i){var o=Math.min,a=Math.max,s=o(e.x,t.x),r=a(e.x,t.x);return o=o(e.y,t.y),a=a(e.y,t.y),n.x>=s&&n.x<=r&&n.y>=o&&n.y<=a?Math.abs(t.x-e.x)<=i?!0:Math.abs((t.y-e.y)/(t.x-e.x)*(n.x-e.x)+e.y-n.y)<=i:!1}},arrow:{render:function(e,t,n,i,o){o=o.getCtx(),i&&(i=e,e=t,t=i),i=new d(t.x-e.x,t.y-e.y),i.$scale(n/i.norm()),n=new d(t.x-i.x,t.y-i.y);var a=new d(-i.y/2,i.x/2);i=n.add(a),n=n.$add(a.$scale(-1)),o.beginPath(),o.moveTo(e.x,e.y),o.lineTo(t.x,t.y),o.stroke(),o.beginPath(),o.moveTo(i.x,i.y),o.lineTo(n.x,n.y),o.lineTo(t.x,t.y),o.closePath(),o.fill()},contains:function(e,t,n,i){return g.line.contains(e,t,n,i)}},hyperline:{render:function(e,t,n,i){function o(e,t){return t>e?e+Math.PI>t?!1:!0:t+Math.PI>e?!0:!1}i=i.getCtx();var a=function(e,t){var n=e.x*t.y-e.y*t.x,i=e.squaredNorm(),o=t.squaredNorm();if(0==n)return{x:0,y:0,ratio:-1};var a=(e.y*o-t.y*i+e.y-t.y)/n;return n=(t.x*i-e.x*o+t.x-e.x)/n,i=(a*a+n*n)/4-1,0>i?{x:0,y:0,ratio:-1}:(i=Math.sqrt(i),{x:-a/2,y:-n/2,ratio:i>1e3?-1:i,a:a,b:n})}(e,t);a.a>1e3||a.b>1e3||a.ratio<0?(i.beginPath(),i.moveTo(e.x*n,e.y*n),i.lineTo(t.x*n,t.y*n)):(t=Math.atan2(t.y-a.y,t.x-a.x),e=Math.atan2(e.y-a.y,e.x-a.x),o=o(t,e),i.beginPath(),i.arc(a.x*n,a.y*n,a.ratio*n,t,e,o)),i.stroke()},contains:e.lambda(!1)}};f.Plot={initialize:function(e,t){this.viz=e,this.config=e.config,this.node=e.config.Node,this.edge=e.config.Edge,this.animation=new i,this.nodeTypes=new t.Plot.NodeTypes,this.edgeTypes=new t.Plot.EdgeTypes,this.labels=e.labels},nodeHelper:p,edgeHelper:g,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(e,t,n){return e+(t-e)*n},moebius:function(e,t,n,i){if(t=i.scale(-n),t.norm()<1){n=t.x,i=t.y;var o=e.startPos.getc().moebiusTransformation(t);e.pos.setc(o.x,o.y),t.x=n,t.y=i}},linear:function(e,t,n){t=e.startPos.getc(!0);var i=e.endPos.getc(!0);e.pos.setc(this.compute(t.x,i.x,n),this.compute(t.y,i.y,n))},polar:function(e,t,n){t=e.startPos.getp(!0),n=e.endPos.getp().interpolate(t,n),e.pos.setp(n.theta,n.rho)},number:function(e,t,n,i,o){var a=e[i](t,"start");i=e[i](t,"end"),e[o](t,this.compute(a,i,n))},color:function(t,n,i,o,a){var s=e.hexToRgb(t[o](n,"start"));o=e.hexToRgb(t[o](n,"end"));var r=this.compute;i=e.rgbToHex([parseInt(r(s[0],o[0],i)),parseInt(r(s[1],o[1],i)),parseInt(r(s[2],o[2],i))]),t[a](n,i)},"array-number":function(e,t,n,i,o){var a=e[i](t,"start");i=e[i](t,"end");for(var s=[],r=0,h=a.length;h>r;r++){var c=a[r],l=i[r];if(c.length){for(var d=0,u=c.length,f=[];u>d;d++)f.push(this.compute(c[d],l[d],n));s.push(f)}else s.push(this.compute(c,l,n))}e[o](t,s)},node:function(e,t,n,i,o,a){if(i=this[i],t)for(var s=t.length,r=0;s>r;r++){var h=t[r];this[i[h]](e,h,n,o,a)}else for(h in i)this[i[h]](e,h,n,o,a)},edge:function(e,t,n,i,o,a){e=e.adjacencies;for(var s in e)this.node(e[s],t,n,i,o,a)},"node-property":function(e,t,n){this.node(e,t,n,"map","getData","setData")},"edge-property":function(e,t,n){this.edge(e,t,n,"map","getData","setData")},"label-property":function(e,t,n){this.node(e,t,n,"label","getLabelData","setLabelData")},"node-style":function(e,t,n){this.node(e,t,n,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(e,t,n){this.edge(e,t,n,"canvas","getCanvasStyle","setCanvasStyle")}},sequence:function(t){var n=this;t=e.merge({condition:e.lambda(!1),step:e.empty,onComplete:e.empty,duration:200},t||{});var i=setInterval(function(){t.condition()?t.step():(clearInterval(i),t.onComplete()),n.viz.refresh(!0)},t.duration)},prepare:function(t){var n=this.viz.graph,i={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}},o={};if("array"==e.type(t))for(var a=0,s=t.length;s>a;a++){var r=t[a].split(":");o[r.shift()]=r}else for(a in t)"position"==a?o[t.position]=[]:o[a]=e.splat(t[a]);return n.eachNode(function(t){t.startPos.set(t.pos),e.each(["node-property","node-style"],function(e){if(e in o)for(var n=o[e],a=0,s=n.length;s>a;a++)t[i[e].setter](n[a],t[i[e].getter](n[a]),"start")}),e.each(["edge-property","edge-style"],function(e){if(e in o){var n=o[e];t.eachAdjacency(function(t){for(var o=0,a=n.length;a>o;o++)t[i[e].setter](n[o],t[i[e].getter](n[o]),"start")})}})}),o},animate:function(t,n){t=e.merge(this.viz.config,t||{});var i=this,o=this.viz.graph,a=this.Interpolator,s="nodefx"===t.type?this.nodeFxAnimation:this.animation,r=this.prepare(t.modes);t.hideLabels&&this.labels.hideLabels(!0),s.setOptions(e.merge(t,{$animating:!1,compute:function(e){o.eachNode(function(t){for(var i in r)a[i](t,r[i],e,n)}),i.plot(t,this.$animating,e),this.$animating=!0},complete:function(){t.hideLabels&&i.labels.hideLabels(!1),i.plot(t),t.onComplete(),t.onAfterCompute()}})).start()},nodeFx:function(t){var n=this.viz,i=n.graph,o=this.nodeFxAnimation,a=e.merge(this.viz.config,{elements:{id:!1,properties:{}},reposition:!1});t=e.merge(a,t||{},{onBeforeCompute:e.empty,onAfterCompute:e.empty}),o.stopTimer();var s=t.elements.properties;t.elements.id?(o=e.splat(t.elements.id),e.each(o,function(e){if(e=i.getNode(e))for(var t in s)e.setData(t,s[t],"end")})):i.eachNode(function(e){for(var t in s)e.setData(t,s[t],"end")}),o=[];for(var r in s)o.push(r);r=["node-property:"+o.join(":")],t.reposition&&(r.push("linear"),n.compute("end")),this.animate(e.merge(t,{modes:r,type:"nodefx"}))},plot:function(e,t){var n=this.viz,i=n.graph,o=n.canvas;n=n.root;var a=this,s=o.getCtx(),r=Math.min;if(e=e||this.viz.controller,e.clearCanvas&&o.clear(),n=i.getNode(n)){var h=!!n.visited;i.eachNode(function(n){var i=n.getData("alpha");n.eachAdjacency(function(c){var l=c.nodeTo;!!l.visited===h&&n.drawn&&l.drawn&&(!t&&e.onBeforePlotLine(c),s.save(),s.globalAlpha=r(i,l.getData("alpha"),c.getData("alpha")),a.plotLine(c,o,t),s.restore(),!t&&e.onAfterPlotLine(c))}),s.save(),n.drawn&&(!t&&e.onBeforePlotNode(n),a.plotNode(n,o,t),!t&&e.onAfterPlotNode(n)),!a.labelsHidden&&e.withLabels&&(n.drawn&&i>=.95?a.labels.plotLabel(o,n,e):a.labels.hideLabel(n,!1)),s.restore(),n.visited=!h})}},plotTree:function(e,t,n){var i=this,o=this.viz.canvas,a=o.getCtx(),s=e.getData("alpha");e.eachSubnode(function(r){if(t.plotSubtree(e,r)&&r.exist&&r.drawn){var h=e.getAdjacency(r.id);!n&&t.onBeforePlotLine(h),a.globalAlpha=Math.min(s,r.getData("alpha")),i.plotLine(h,o,n),!n&&t.onAfterPlotLine(h),i.plotTree(r,t,n)}}),e.drawn?(!n&&t.onBeforePlotNode(e),this.plotNode(e,o,n),!n&&t.onAfterPlotNode(e),!t.hideLabels&&t.withLabels&&s>=.95?this.labels.plotLabel(o,e,t):this.labels.hideLabel(e,!1)):this.labels.hideLabel(e,!0)},plotNode:function(e,t,n){var i=e.getData("type"),o=this.node.CanvasStyles;if("none"!=i){var a=e.getData("lineWidth"),s=e.getData("color"),r=e.getData("alpha"),h=t.getCtx();h.lineWidth=a,h.fillStyle=h.strokeStyle=s,h.globalAlpha=r;for(var c in o)h[c]=e.getCanvasStyle(c);this.nodeTypes[i].render.call(this,e,t,n)}},plotLine:function(e,t,n){var i=e.getData("type"),o=this.edge.CanvasStyles;if("none"!=i){var a=e.getData("lineWidth"),s=e.getData("color"),r=t.getCtx();r.lineWidth=a,r.fillStyle=r.strokeStyle=s;for(var h in o)r[h]=e.getCanvasStyle(h);this.edgeTypes[i].render.call(this,e,t,n)}}},f.Label={},f.Label.Native=new t({plotLabel:function(e,t,n){var i=e.getCtx();t.pos.getc(!0),i.font=t.getLabelData("style")+" "+t.getLabelData("size")+"px "+t.getLabelData("family"),i.textAlign=t.getLabelData("textAlign"),i.fillStyle=i.strokeStyle=t.getLabelData("color"),i.textBaseline=t.getLabelData("textBaseline"),this.renderLabel(e,t,n)},renderLabel:function(e,t){var n=e.getCtx(),i=t.pos.getc(!0);n.fillText(t.name,i.x,i.y+t.getData("height")/2)},hideLabel:e.empty,hideLabels:e.empty}),f.Label.DOM=new t({labelsHidden:!1,labelContainer:!1,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(e){return e in this.labels&&null!=this.labels[e]?this.labels[e]:this.labels[e]=document.getElementById(e)},hideLabels:function(e){this.getLabelContainer().style.display=e?"none":"",this.labelsHidden=e},clearLabels:function(e){for(var t in this.labels)(e||!this.viz.graph.hasNode(t))&&(this.disposeLabel(t),delete this.labels[t])},disposeLabel:function(e){(e=this.getLabel(e))&&e.parentNode&&e.parentNode.removeChild(e)},hideLabel:function(t,n){t=e.splat(t);var i=n?"":"none",o=this;e.each(t,function(e){(e=o.getLabel(e.id))&&(e.style.display=i)})},fitsInCanvas:function(e,t){var n=t.getSize();return e.x>=n.width||e.x<0||e.y>=n.height||e.y<0?!1:!0}}),f.Label.HTML=new t({Implements:f.Label.DOM,plotLabel:function(e,t,n){e=t.id;var i=this.getLabel(e);if(!i&&!(i=document.getElementById(e))){i=document.createElement("div");var o=this.getLabelContainer();i.id=e,i.className="node",i.style.position="absolute",n.onCreateLabel(i,t),o.appendChild(i),this.labels[t.id]=i}this.placeLabel(i,t,n)}}),f.Label.SVG=new t({Implements:f.Label.DOM,plotLabel:function(e,t,n){e=t.id;var i=this.getLabel(e);if(!i&&!(i=document.getElementById(e))){i=document.createElementNS("http://www.w3.org/2000/svg","svg:text");var o=document.createElementNS("http://www.w3.org/2000/svg","svg:tspan");i.appendChild(o),o=this.getLabelContainer(),i.setAttribute("id",e),i.setAttribute("class","node"),o.appendChild(i),n.onCreateLabel(i,t),this.labels[t.id]=i}this.placeLabel(i,t,n)}}),a=$jit.Layouts={},a.TM={},a.TM.SliceAndDice=new t({compute:function(e){var t=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(t);var n=this.canvas.getSize(),i=this.config,o=n.width;n=n.height,this.graph.computeLevels(this.root,0,"ignore"),t.getPos(e).setc(-o/2,-n/2),t.setData("width",o,e),t.setData("height",n+i.titleHeight,e),this.computePositions(t,t,this.layout.orientation,e),this.controller.onAfterCompute(t)},computePositions:function(e,t,n,i){var o=0;e.eachSubnode(function(e){o+=e.getData("area",i)});var a=this.config,s=e.getData("width",i),r=e.getData("height",i)-a.titleHeight;e=e==t?1:t.getData("area",i)/o;var h,c,l,d,u;"h"==n?(n="v",r=r,s*=e,h="height",c="y",l="x",d=a.titleHeight,u=0):(n="h",r*=e,s=s,h="width",c="x",l="y",d=0,u=a.titleHeight);var f=t.getPos(i);t.setData("width",s,i),t.setData("height",r,i);var p=0,g=this;t.eachSubnode(function(e){var o=e.getPos(i);o[c]=p+f[c]+d,o[l]=f[l]+u,g.computePositions(t,e,n,i),p+=e.getData(h,i)})}}),a.TM.Area={compute:function(e){e=e||"current";var t=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(t);var n=this.config,i=this.canvas.getSize(),o=i.width;i=i.height;var a=n.offset,s=o-a;a=i-a,this.graph.computeLevels(this.root,0,"ignore"),t.getPos(e).setc(-o/2,-i/2),t.setData("width",o,e),t.setData("height",i,e),this.computePositions(t,{top:-i/2+n.titleHeight,left:-o/2,width:s,height:a-n.titleHeight},e),this.controller.onAfterCompute(t)},computeDim:function(e,t,n,i,o,a){if(e.length+t.length==1)this.layoutLast(1==e.length?e:t,n,i,a);else if(e.length>=2&&0==t.length&&(t=[e.shift()]),0==e.length)t.length>0&&this.layoutRow(t,n,i,a);else{var s=e[0];o(t,n)>=o([s].concat(t),n)?this.computeDim(e.slice(1),t.concat([s]),n,i,o,a):(t=this.layoutRow(t,n,i,a),this.computeDim(e,[],t.dim,t,o,a))}},worstAspectRatio:function(e,t){if(!e||0==e.length)return Number.MAX_VALUE;for(var n=0,i=0,o=Number.MAX_VALUE,a=0,s=e.length;s>a;a++){var r=e[a]._area;n+=r,o=r>o?o:r,i=i>r?i:r}return a=t*t,n*=n,Math.max(a*i/n,n/(a*o))},avgAspectRatio:function(e,t){if(!e||0==e.length)return Number.MAX_VALUE;for(var n=0,i=0,o=e.length;o>i;i++){var a=e[i]._area/t;n+=t>a?t/a:a/t}return n/o},layoutLast:function(e,t,n,i){e=e[0],e.getPos(i).setc(n.left,n.top),e.setData("width",n.width,i),e.setData("height",n.height,i)}},a.TM.Squarified=new t({Implements:a.TM.Area,computePositions:function(e,t,n){var i=this.config;this.layout.orientation=t.width>=t.height?"h":"v";var o=e.getSubnodes([1,1],"ignore");if(o.length>0){this.processChildrenLayout(e,o,t,n),e=0;for(var a=o.length;a>e;e++){var s=o[e],r=i.offset;t=s.getData("height",n)-r-i.titleHeight,r=s.getData("width",n)-r;var h=s.getPos(n);t={width:r,height:t,top:h.y+i.titleHeight,left:h.x},this.computePositions(s,t,n)}}},processChildrenLayout:function(e,t,n,i){e=n.width*n.height;var o,a=t.length,s=0,r=[];for(o=0;a>o;o++)r[o]=parseFloat(t[o].getData("area",i)),s+=r[o];for(o=0;a>o;o++)t[o]._area=e*r[o]/s;e=this.layout.horizontal()?n.height:n.width,t.sort(function(e,t){var n=t._area-e._area;return n?n:t.id==e.id?0:t.id<e.id?1:-1}),o=[t[0]],this.squarify(t.slice(1),o,e,n,i)},squarify:function(e,t,n,i,o){this.computeDim(e,t,n,i,this.worstAspectRatio,o)},layoutRow:function(e,t,n,i){return this.layout.horizontal()?this.layoutV(e,t,n,i):this.layoutH(e,t,n,i)},layoutV:function(t,n,i,o){var a=0;e.each(t,function(e){a+=e._area}),n=a/n;for(var s=0,r=0,h=t.length;h>r;r++){var c=t[r]._area/n,l=t[r];l.getPos(o).setc(i.left,i.top+s),l.setData("width",n,o),l.setData("height",c,o),s+=c}return t={height:i.height,width:i.width-n,top:i.top,left:i.left+n},t.dim=Math.min(t.width,t.height),t.dim!=t.height&&this.layout.change(),t},layoutH:function(t,n,i,o){var a=0;e.each(t,function(e){a+=e._area});for(var s=a/n,r=i.top,h=0,c=0,l=t.length;l>c;c++){var d=t[c];n=d._area/s,d.getPos(o).setc(i.left+h,r),d.setData("width",n,o),d.setData("height",s,o),h+=n}return t={height:i.height-s,width:i.width,top:i.top+s,left:i.left},t.dim=Math.min(t.width,t.height),t.dim!=t.width&&this.layout.change(),t}}),a.TM.Strip=new t({Implements:a.TM.Area,computePositions:function(e,t,n){var i=e.getSubnodes([1,1],"ignore"),o=this.config;if(i.length>0){this.processChildrenLayout(e,i,t,n),e=0;for(var a=i.length;a>e;e++){var s=i[e],r=o.offset;t=s.getData("height",n)-r-o.titleHeight,r=s.getData("width",n)-r;var h=s.getPos(n);t={width:r,height:t,top:h.y+o.titleHeight,left:h.x},this.computePositions(s,t,n)}}},processChildrenLayout:function(e,t,n,i){e=n.width*n.height;var o,a=t.length,s=0,r=[];for(o=0;a>o;o++)r[o]=+t[o].getData("area",i),s+=r[o];for(o=0;a>o;o++)t[o]._area=e*r[o]/s;e=this.layout.horizontal()?n.width:n.height,o=[t[0]],this.stripify(t.slice(1),o,e,n,i)},stripify:function(e,t,n,i,o){this.computeDim(e,t,n,i,this.avgAspectRatio,o)},layoutRow:function(e,t,n,i){return this.layout.horizontal()?this.layoutH(e,t,n,i):this.layoutV(e,t,n,i)},layoutV:function(t,n,i,o){var a=0;e.each(t,function(e){a+=e._area});for(var s=a/n,r=0,h=0,c=t.length;c>h;h++){var l=t[h],d=l._area/s;l.getPos(o).setc(i.left,i.top+(n-d-r)),l.setData("width",s,o),l.setData("height",d,o),r+=d}return{height:i.height,width:i.width-s,top:i.top,left:i.left+s,dim:n}},layoutH:function(t,n,i,o){var a=0;e.each(t,function(e){a+=e._area});for(var s=a/n,r=i.height-s,h=0,c=0,l=t.length;l>c;c++){var d=t[c],u=d._area/s;d.getPos(o).setc(i.left+h,i.top+r),d.setData("width",u,o),d.setData("height",s,o),h+=u}return{height:i.height-s,width:i.width,top:i.top,left:i.left,dim:n}}}),a.Icicle=new t({compute:function(e){e=e||"current";var t=this.graph.getNode(this.root),n=this.config,i=this.canvas.getSize(),o=i.width;i=i.height,n=n.constrained?n.levelsToShow:Number.MAX_VALUE,this.controller.onBeforeCompute(t),f.Util.computeLevels(this.graph,t.id,0,"ignore");var a=0;f.Util.eachLevel(t,0,!1,function(e,t){t>a&&(a=t)}),t=this.graph.getNode(this.clickedNode&&this.clickedNode.id||t.id),n=Math.min(a,n-1);var s=t._depth;this.layout.horizontal()?this.computeSubtree(t,-o/2,-i/2,o/(n+1),i,s,n,e):this.computeSubtree(t,-o/2,-i/2,o,i/(n+1),s,n,e)},computeSubtree:function(t,n,i,o,a,s,r,h){t.getPos(h).setc(n,i),t.setData("width",o,h),t.setData("height",a,h);var c=0,l=f.Util.getSubnodes(t,[1,1]);if(l.length){e.each(l,function(e){c+=e.getData("dim")});for(var d=0,u=l.length;u>d;d++)this.layout.horizontal()?(t=a*l[d].getData("dim")/c,this.computeSubtree(l[d],n+o,i,o,t,s,r,h),i+=t):(t=o*l[d].getData("dim")/c,this.computeSubtree(l[d],n,i+a,t,a,s,r,h),n+=t)}}}),$jit.Icicle=new t({Implements:[{construct:function(t){var n="array"==e.type(t),i=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);return n?function(t,n){for(var i=function(e){for(var i=0,o=n.length;o>i;i++)if(n[i].id==e)return n[i];return t.addNode({id:e,name:e})},o=0,a=n.length;a>o;o++){t.addNode(n[o]);var s=n[o].adjacencies;if(s)for(var r=0,h=s.length;h>r;r++){var c=s[r],l={};"string"!=typeof s[r]&&(l=e.merge(c.data,{}),c=c.nodeTo),t.addAdjacence(n[o],i(c),l)}}}(i,t):function(e,t){if(e.addNode(t),t.children)for(var n=0,i=t.children;n<i.length;n++)e.addAdjacence(t,i[n]),arguments.callee(e,i[n])}(i,t),i},loadJSON:function(t,n){this.json=t,this.labels&&this.labels.clearLabels&&this.labels.clearLabels(!0),this.graph=this.construct(t),this.root="array"!=e.type(t)?t.id:t[n?n:0].id},toJSON:function(e){if(e=e||"tree","tree"==e){var t={};t=function i(e){var t={};t.id=e.id,t.name=e.name,t.data=e.data;var n=[];return e.eachSubnode(function(e){n.push(i(e))}),t.children=n,t}(this.graph.getNode(this.root))}else{t=[];var n=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(e){var i={};i.id=e.id,i.name=e.name,i.data=e.data;var o=[];e.eachAdjacency(function(e){var t=e.nodeTo;if(!!t.visited===n){var i={};i.nodeTo=t.id,i.data=e.data,o.push(i)}}),i.adjacencies=o,t.push(i),e.visited=!n})}return t}},h,a.Icicle],layout:{orientation:"h",vertical:function(){return"v"==this.orientation},horizontal:function(){return"h"==this.orientation},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(t){var n={animate:!1,orientation:"h",offset:2,levelsToShow:Number.MAX_VALUE,constrained:!1,Node:{type:"rectangle",overridable:!0},Edge:{type:"none"},Label:{type:"Native"},duration:700,fps:45},i=o("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label");this.controller=this.config=e.merge(i,n,t),this.layout.orientation=this.config.orientation,t=this.config,t.useCanvas?(this.canvas=t.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(this.canvas=new c(this,t),this.config.labelContainer=("string"==typeof t.injectInto?t.injectInto:t.injectInto.id)+"-label"),this.graphOptions={complex:!0,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label),this.labels=new $jit.Icicle.Label[this.config.Label.type](this),this.fx=new $jit.Icicle.Plot(this,$jit.Icicle),this.op=new $jit.Icicle.Op(this),this.group=new $jit.Icicle.Group(this),this.clickedNode=null,this.initializeExtras()},refresh:function(){if("Native"!=this.config.Label.type){var e=this;this.graph.eachNode(function(t){e.labels.hideLabel(t,!1)})}this.compute(),this.plot()},plot:function(){this.fx.plot(this.config)},enter:function(e){if(!this.busy){this.busy=!0;var t=this,n=this.config,i={onComplete:function(){n.request&&t.compute(),n.animate?(t.graph.nodeList.setDataset(["current","end"],{alpha:[1,0]}),f.Util.eachSubgraph(e,function(e){e.setData("alpha",1,"end")},"ignore"),t.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){t.clickedNode=e,t.compute("end"),t.fx.animate({modes:["linear","node-property:width:height"],duration:1e3,onComplete:function(){t.busy=!1,t.clickedNode=e}})}})):(t.clickedNode=e,t.busy=!1,t.refresh())}};n.request?this.requestNodes(clickedNode,i):i.onComplete()}},out:function(){if(!this.busy){var e=this,t=f.Util,n=this.config,i=this.graph,o=t.getParents(i.getNode(this.clickedNode&&this.clickedNode.id||this.root))[0],a=this.clickedNode;this.busy=!0,this.events.hoveredNode=!1,o?(callback={onComplete:function(){e.clickedNode=o,n.request?e.requestNodes(o,{onComplete:function(){e.compute(),e.plot(),e.busy=!1}}):(e.compute(),e.plot(),e.busy=!1)}},n.animate?(this.clickedNode=o,this.compute("end"),this.clickedNode=a,this.fx.animate({modes:["linear","node-property:width:height"],duration:1e3,onComplete:function(){e.clickedNode=o,i.nodeList.setDataset(["current","end"],{alpha:[0,1]}),t.eachSubgraph(a,function(e){e.setData("alpha",1)},"ignore"),e.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){callback.onComplete()}})}})):callback.onComplete()):this.busy=!1}},requestNodes:function(t,n){var i=e.merge(this.controller,n),o=this.config.constrained?this.config.levelsToShow:Number.MAX_VALUE;if(i.request){var a=[],s=t._depth;f.Util.eachLevel(t,0,o,function(e){e.drawn&&!f.Util.anySubnode(e)&&(a.push(e),e._level=e._depth-s,this.config.constrained&&(e._level=o-e._level))}),this.group.requestNodes(a,i)}else i.onComplete()}}),$jit.Icicle.Op=new t({Implements:f.Op}),$jit.Icicle.Group=new t({initialize:function(e){this.viz=e,this.canvas=e.canvas,this.config=e.config},requestNodes:function(e,t){var n=0,i=e.length,o=this.viz;0==i&&t.onComplete();
for(var a=0;i>a;a++)t.request(e[a].id,e[a]._level,{onComplete:function(e,a){a&&a.children&&(a.id=e,o.op.sum(a,{type:"nothing"})),++n==i&&(f.Util.computeLevels(o.graph,o.root,0),t.onComplete())}})}}),$jit.Icicle.Plot=new t({Implements:f.Plot,plot:function(t,n){t=t||this.viz.controller;var i=this.viz,o=i.graph.getNode(i.clickedNode&&i.clickedNode.id||i.root),a=o._depth;i.canvas.clear(),this.plotTree(o,e.merge(t,{withLabels:!0,hideLabels:!1,plotSubtree:function(e,t){return!i.config.constrained||t._depth-a<i.config.levelsToShow}}),n)}}),$jit.Icicle.Label={},$jit.Icicle.Label.Native=new t({Implements:f.Label.Native,renderLabel:function(e,t){var n=e.getCtx(),i=t.getData("width"),o=t.getData("height"),a=t.getLabelData("size"),s=n.measureText(t.name);1.5*a>o||i<s.width||(a=t.pos.getc(!0),n.fillText(t.name,a.x+i/2,a.y+o/2))}}),$jit.Icicle.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(e){this.viz=e},placeLabel:function(e,t,n){var i=t.pos.getc(!0),o=this.viz.canvas.getSize();i={x:Math.round(i.x+o.width/2),y:Math.round(i.y+o.height/2)},e.setAttribute("x",i.x),e.setAttribute("y",i.y),n.onPlaceLabel(e,t)}}),$jit.Icicle.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(e){this.viz=e},placeLabel:function(e,t,n){var i=t.pos.getc(!0),o=this.viz.canvas.getSize();i={x:Math.round(i.x+o.width/2),y:Math.round(i.y+o.height/2)},o=e.style,o.left=i.x+"px",o.top=i.y+"px",o.display="",n.onPlaceLabel(e,t)}}),$jit.Icicle.Plot.NodeTypes=new t({none:{render:e.empty},rectangle:{render:function(t,n){var i=this.viz.config,o=i.offset,a=t.getData("width"),s=t.getData("height"),r=t.getData("border"),h=t.pos.getc(!0),c=h.x+o/2,l=h.y+o/2,d=n.getCtx();if(!(2>a-o||2>s-o)){if(i.cushion){i=t.getData("color");var u=d.createRadialGradient(c+(a-o)/2,l+(s-o)/2,1,c+(a-o)/2,l+(s-o)/2,s>a?s:a),f=e.rgbToHex(e.map(e.hexToRgb(i),function(e){return.3*e>>0}));u.addColorStop(0,i),u.addColorStop(1,f),d.fillStyle=u}r&&(d.strokeStyle=r,d.lineWidth=3),d.fillRect(c,l,Math.max(0,a-o),Math.max(0,s-o)),r&&d.strokeRect(h.x,h.y,a,s)}},contains:function(e,t){if(this.viz.clickedNode&&!$jit.Graph.Util.isDescendantOf(e,this.viz.clickedNode.id))return!1;var n=e.pos.getc(!0),i=e.getData("width"),o=e.getData("height");return this.nodeHelper.rectangle.contains({x:n.x+i/2,y:n.y+o/2},t,i,o)}}}),$jit.Icicle.Plot.EdgeTypes=new t({none:e.empty})}();